input {
    gelf {
        port => "${GELF_PORT}"
        type => "docker"
    }
    udp {
        port => "${LOGSTASH_PORT}"
        codec => "json"
    }
    beats {
        port => "${LOGSTASH_PORT}"
        tags => ["nginx"]
        codec => "json"
    }
}
output {
  if "nginx" in [tags] {
      elasticsearch {
        hosts => [ "${ES_HOST}" ]
        index => "nginx-%{+YYYY.MM.dd}"
      }
  } else if "auth" in [tags] {
      elasticsearch {
          hosts => [ "${ES_HOST}" ]
          index => "auth-%{+YYYY.MM.dd}"
      }
  } else if "async-api" in [tags] {
      elasticsearch {
          hosts => [ "${ES_HOST}" ]
          index => "async-api-%{+YYYY.MM.dd}"
      }
  } else if "async-api-elasticsearch" == [tag] {
      elasticsearch {
          hosts => [ "${ES_HOST}" ]
          index => "async-api-elasticsearch-%{+YYYY.MM.dd}"
      }
  } else  if "redis" == [tag] {
      elasticsearch {
          hosts => [ "${ES_HOST}" ]
          index => "redis-%{+YYYY.MM.dd}"
      }
  } else if "postgres" == [tag] {
      elasticsearch {
          hosts => [ "${ES_HOST}" ]
          index => "postgres-%{+YYYY.MM.dd}"
      }
  } else if "etl" == [tag] {
      elasticsearch {
          hosts => [ "${ES_HOST}" ]
          index => "etl-%{+YYYY.MM.dd}"
      }
  } else if "admin-panel" in [tags] {
      elasticsearch {
          hosts => [ "${ES_HOST}" ]
          index => "admin-panel-%{+YYYY.MM.dd}"
      }
  } else if "ugc" in [tags] {
      elasticsearch {
          hosts => [ "${ES_HOST}" ]
          index => "ugc-%{+YYYY.MM.dd}"
      }
  } else if "zookeeper" == [tag] {
      elasticsearch {
          hosts => [ "${ES_HOST}" ]
          index => "zookeeper-%{+YYYY.MM.dd}"
      }
  } else if [tag] in ["broker", "broker-ui"] {
      elasticsearch {
          hosts => [ "${ES_HOST}" ]
          index => "broker-%{+YYYY.MM.dd}"
      }
  } else if "clickhouse" == [tag] {
      elasticsearch {
          hosts => [ "${ES_HOST}" ]
          index => "clickhouse-%{+YYYY.MM.dd}"
      }
  } else if "jaeger" == [tag] {
      elasticsearch {
          hosts => [ "${ES_HOST}" ]
          index => "jaeger-%{+YYYY.MM.dd}"
      }
  } 
  stdout {}
}