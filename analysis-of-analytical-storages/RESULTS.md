# –ó–∞–¥–∞–Ω–∏–µ –ø–æ –≤—ã–±–æ—Ä—É —Ö—Ä–∞–Ω–∏–ª–∏—â–∞
–í –∫–∞—á–µ—Å—Ç–≤–µ –∫–∞–Ω–¥–∏–¥–∞—Ç–æ–≤ –¥–ª—è –≤—ã–±–æ—Ä–∞ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞ –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö –±—ã–ª–∏ –≤—ã–±—Ä–∞–Ω—ã ClickHouse –∏ MONGO. –ò—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ –ø–æ–∫–∞–∑–∞–ª–æ, —á—Ç–æ MONGO –±—ã—Å—Ç—Ä–µ–µ —Å–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è —Å –∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏–º–∏ –∑–∞–ø—Ä–æ—Å–∞–º–∏, —á–µ–º ClickHouse.
–î–ª—è –ø—Ä–∏–º–µ—Ä–∞ —Å—Ä–∞–≤–Ω–∏–º —Å–∫–æ—Ä–æ—Å—Ç—å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –æ–¥–∏–Ω–∞–∫–æ–≤—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ –æ–±–µ–∏—Ö –ë–î.


### üöÄ –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤
–ß—Ç–æ–±—ã –ø–æ–¥–Ω—è—Ç—å —Ç–µ—Å—Ç—ã –Ω–∞–¥–æ –≤—ã–ø–æ–ª–Ω–∏—Ç—å —Å–ª–µ–¥—É—é—â–∏–µ –∫–æ–º–∞–Ω–¥—ã 
   (—É –≤–∞—Å –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω docker-compose –∏ python3):
- `python3 -m venv venv && source venv/bin/activate && pip install -r requirements.txt`
- `docker-compose up -d`
- `python test.py`


### üìô –û–ø–∏—Å–∞–Ω–∏—è —Ç–µ—Å—Ç–æ–≤:
- `select_count` - –ø–æ–¥—Å—á–∏—Ç–∞—Ç—å –∫–æ–ª-–≤–æ –∑–∞–ø–∏—Å–µ–π –≤ —Ç–∞–±–ª–∏—Ü–µ
  #### –∑–∞–ø—Ä–æ—Å: 
      SELECT COUNT(*) FROM view
- `select_count_distinct_movie_id` - –ø–æ–¥—Å—á–∏—Ç–∞—Ç—å –∫–æ–ª-–≤–æ –∑–∞–ø–∏—Å–µ–π c —É–Ω–∏–∫–∞–ª—å–Ω—ã–º–∏ movie_id –≤ —Ç–∞–±–ª–∏—Ü–µ
  #### –∑–∞–ø—Ä–æ—Å: 
      SELECT count(DISTINCT movie_id) FROM views

- `select_distinct_likes_by_movies_id` - –ø–æ–¥—Å—á–∏—Ç–∞—Ç—å –∫–æ–ª-–≤–æ —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –ª–∞–π–∫–æ–≤ –ø–æ –∫–∞–∂–¥–æ–º—É —Ñ–∏–ª—å–º—É
  #### –∑–∞–ø—Ä–æ—Å:
      SELECT
         movies_id,
         count(distinct likes)
      FROM views
      GROUP by user_id
- `select_sum_and_max_stars` - –Ω–∞–π—Ç–∏ sum and max stars —É –∫–∞–∂–¥–æ–≥–æ —Ñ–∏–ª—å–º–∞ 
  #### –∑–∞–ø—Ä–æ—Å: 
      SELECT 
            movies_id, 
            sum(stars),
            max(stars) 
        FROM views
        GROUP by movies_id

- `insert_values` - –≤—Å—Ç–∞–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö –≤ –ë–î
  #### –∑–∞–ø—Ä–æ—Å CLICK HOUSE:
      INSERT INTO views VALUES


### üìò –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–æ–≤

| –¢–µ—Å—Ç                                 | ClickHouse, sec | MONGO, sec |
|--------------------------------------|:---------------:|:----------:|
| `select_count`                       |     0.0028      |   0.0100   |
| `select_count_distinct_movie_id`     |     0.1183      |   0.2366   |
| `select_distinct_likes_by_movies_id` |   2.6907    |  10.4877   |
| `select_sum_and_max_stars`           |   0.4162    |   1.7255   |
| `insert 10 000 000 rows`             |   179.1    |   182.3    |


–ö–∞–∫ –≤–∏–¥–Ω–æ –ø–æ –¥–∞–Ω–Ω—ã–º, –ø—Ä–∏ —Å—Ö–æ–∂–∏—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–∞—Ö, –≤ –∑–∞–ø—Ä–æ—Å–∞—Ö –Ω–∞ –ø–æ–ª—É—á–µ–Ω–∏–µ –∏ –≤—Å—Ç–∞–≤–∫—É –¥–∞–Ω–Ω—ã—Ö Clickhouse –æ–±–≥–æ–Ω—è–µ—Ç Vertica –≤ —Ä–∞–∑—ã.

### –í—ã–≤–æ–¥
–ë—ã–ª–æ —Ä–µ—à–µ–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å MONGO, —Ç–∞–∫ –∫–∞–∫ –æ–Ω –±—ã—Å—Ç—Ä–µ–µ —Å–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è —Å –∑–∞–¥–∞—á–∞–º–∏ –≤—Å—Ç–∞–≤–∫–∏ –∏ –∞–≥—Ä–µ–≥–∞—Ü–∏–∏.