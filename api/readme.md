# API для приёма событий по созданию уведомлений 

Принимает ивенты от планировщика и сервисов, генерирующих события, кладет их в RabbitMQ.

API представляет из себя две ручки, на которую будут приходить запросы вида:

Приветственное письмо на `/api/v1/user_registration`:
```
{
    "user_id": "39275483-d542-400a-bb7c-6aefa15fbee6",
}
```

Все остальное на `/api/v1/send_notification`. Например, рекомендации от команды на рождество:
```
{
   "event_type":"common",
   "transport":"email",
   "payload":{
      "users_id":[
         "39275483-d542-400a-bb7c-6aefa15fbee6",
         "39275483-d542-400a-bb7c-6aefa15fbee6"
      ],
      "films":[
         "380164b8-7503-4c15-b83d-88de95743880",
         "380164b8-7503-4c15-b83d-88de95743880",
         "380164b8-7503-4c15-b83d-88de95743880"
      ]
   }
}
```

Или персональная рассылка:
```
{
   "event_type":"monthly_personal_statistic",
   "transport":"email",
   "payload":{
      "users_id":"39275483-d542-400a-bb7c-6aefa15fbee6",
      "films":[
         "380164b8-7503-4c15-b83d-88de95743880",
         "380164b8-7503-4c15-b83d-88de95743880",
         "380164b8-7503-4c15-b83d-88de95743880"
      ]
   }
}
```

Далее эти запросы перекладываются в RabbitMQ, откуда вычитываются воркером.

С ростом нагрузки, мы создадим дополнительные инстансы очереди (High, Default, Low) в которые будем перекладывать 
события в зависимости от их важности. Например, ивенты от Auth будут улетать в High очередь, персонифицированные 
в Default, а массовые рассылки в Low.

[Swagger](http://127.0.0.1:8001/docs)